* ob-cypher

[[http://melpa.org/#/ob-cypher][file:http://melpa.org/packages/ob-cypher-badge.svg]]

query neo4j using cypher in org-mode blocks

** Options
This package is a wrapper around the [[https://neo4j.com/docs/http-api][Neo4j HTTP API]]. At present the Bolt protocol is not supported.

| Argument   | Description                       | Example                               | Default   | Comment                    |
|------------+-----------------------------------+---------------------------------------+-----------+----------------------------|
| =:host=      | Host                              | =#+BEGIN_SRC cypher :host "192.0.2.1"=  | =127.0.0.1= |                            |
| =:http-port= | Neo4j HTTP port                   | =#+BEGIN_SRC cypher :http-port 8888=    | =7474=      |                            |
| =:username=  | Username                          | =#+BEGIN_SRC cypher :username bob=      | =neo4j=     |                            |
| =:password=  | Password                          | =#+BEGIN_SRC cypher :password password= | =neo4j=     |                            |
| =:file=      | Image file of graph visualisation | =#+BEGIN_SRC cypher :file graph.png=    | None      | Requires =curl= and =graphviz= |

** Examples

: #+BEGIN_SRC cypher
: CREATE (matrix1:Movie { title : 'The Matrix', year : '1999-03-31' })
: CREATE (matrix2:Movie { title : 'The Matrix Reloaded', year : '2003-05-07' })
: CREATE (matrix3:Movie { title : 'The Matrix Revolutions', year : '2003-10-27' })
: CREATE (keanu:Actor { name:'Keanu Reeves' })
: CREATE (laurence:Actor { name:'Laurence Fishburne' })
: CREATE (carrieanne:Actor { name:'Carrie-Anne Moss' })
: CREATE (keanu)-[:ACTS_IN { role : 'Neo' }]->(matrix1)
: CREATE (keanu)-[:ACTS_IN { role : 'Neo' }]->(matrix2)
: CREATE (keanu)-[:ACTS_IN { role : 'Neo' }]->(matrix3)
: CREATE (laurence)-[:ACTS_IN { role : 'Morpheus' }]->(matrix1)
: CREATE (laurence)-[:ACTS_IN { role : 'Morpheus' }]->(matrix2)
: CREATE (laurence)-[:ACTS_IN { role : 'Morpheus' }]->(matrix3)
: CREATE (carrieanne)-[:ACTS_IN { role : 'Trinity' }]->(matrix1)
: CREATE (carrieanne)-[:ACTS_IN { role : 'Trinity' }]->(matrix2)
: CREATE (carrieanne)-[:ACTS_IN { role : 'Trinity' }]->(matrix3)
: #+END_SRC

: #+RESULTS:
: : +-------------------+
: : | No data returned. |
: : +-------------------+
: : Nodes created: 6
: : Relationships created: 9
: : Properties set: 18
: : Labels added: 6
: : 1353 ms

: #+BEGIN_SRC cypher :file movie.png
: match (actor)-[r:ACTS_IN]->(movie)
: return *
: #+END_SRC

: #+RESULTS:

[[http://i.imgur.com/dpCyOo5.png]]

** Changelog
*** [1.0.0] - 2020-05-10
- Remove processing of =port= parameter from =org-babel-execute:cypher= as we only support =http-port=, leave =port= available in case Bolt supported in future.
- Update 'Options' table in =README.org= to reflect change in API.

*** [0.0.2] - 2019-09-08
Work courtesy of [[https://github.com/ifitzpat][ifitzpat]] and [[https://github.com/stardiviner][stardiviner]] :clap:

- [X] merge two PRs in zweifisch repo:
  - [X] fix babel header arguments
  - [X] use cURL RESTful request instead of neo4j-shell command
  - [X] support Graphviz dot graph file result
  - [X] fix cURL RESTful request port typos
